import {
  "github.com/myapp/models"
  "github.com/myapp/viewutils"
  time
}
// name: StatusBadge
// param: status models.Status
el {
  css {
    .live-dot {
      display inline-block
      width _6px
      height _6px
      margin-right _6px
      border-radius _50%
      background-color currentColor
      animation blink _1.5s infinite ease-in-out
    }
    &test {
      width _200px
    }
    @keyframes blink {
      _0% {
        opacity _0.4
      }
      _50% {
        opacity _1
      }
      _100% {
        opacity _0.4
      }
    }
  }
  // Type-safe switch on an enum/type
  switch `status` {
    case models.StatusActive {
      .badge.bg-green-500.text-green-950.flex.items-center {
        span.live-dot
        Active
      }
    }
    case models.StatusPending {
      .badge.bg-yellow-500.text-yellow-950 Pending
    }
    case models.StatusFailed {
      .badge.bg-red-500.text-white Failed
    }
    default {
      .badge.bg-gray-500.text-white Unknown
    }
  }
}
// name: Dashboard
// param: stats models.DashboardStats
// param: transactions models.TransactionIterator
el {
  &dashboard-view {
    h1.text-3xl.font-bold.mb-6 Overview
    // Stats Grid using implicit divs
    .grid.grid-cols-1.md:grid-cols-3.gap-6.mb-8 {
      // Stat Card 1
      .stat-card.bg-slate-800.p-6.rounded-lg {
        h3.text-slate-400.text-sm.uppercase "Total Revenue"
        p.text-3xl.font-mono.mt-2 "`viewutils.FormatMoney(stats.Revenue)`"
      }
      // Stat Card 2
      .stat-card.bg-slate-800.p-6.rounded-lg {
        h3.text-slate-400.text-sm.uppercase "Active Users"
        p.text-3xl.font-mono.mt-2 `stats.ActiveUsers`
      }
      // Stat Card 3 with logic
      .stat-card.bg-slate-800.p-6.rounded-lg {
        h3.text-slate-400.text-sm.uppercase "System Load"
        // Conditional text coloring based on value
        if "`stats.SystemLoad > 80`" {
          p.text-3xl.font-mono.mt-2.text-red-400 `stats.SystemLoad`%
        }
        else {
          p.text-3xl.font-mono.mt-2.text-green-400 `stats.SystemLoad`%
        }
      }
    }
    // Transactions Table
    h2.text-xl.font-semibold.mb-4 "Recent Transactions"
    .overflow-x-auto.rounded-lg.border.border-slate-700 {
      table.w-full.text-left.text-sm {
        thead.bg-slate-900.text-slate-400.uppercase {
          tr {
            th.px-6.py-3 ID
            th.px-6.py-3 Customer
            th.px-6.py-3 Date
            th.px-6.py-3 Amount
            th.px-6.py-3 Status
          }
        }
        tbody.divide-y.divide-slate-800.bg-slate-800 {
          // Iterating over the 'transactions' iterator
          each tx of=`transactions` {
            tr.hover:bg-slate-700 {
              td.px-6.py-4.font-mono.text-slate-500 `tx.ID`
              td.px-6.py-4 {
                div.font-medium `tx.CustomerName`
                div.text-xs.text-slate-500 `tx.CustomerEmail`
              }
              td.px-6.py-4 "`tx.CreatedAt.Format(time.RFC822)`"
              td.px-6.py-4 "`viewutils.FormatMoney(tx.Amount)`"
              td.px-6.py-4 {
                // Call the local component defined above
                // Note: We use the generated name 'StatusBadge'
                // Positional properties are acceptable here.
                StatusBadge `tx.Status`
              }
            }
          }
        }
      }
    }
  }
}
